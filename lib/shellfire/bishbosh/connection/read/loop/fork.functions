_bishbosh_connection_read_loop_fork()
{	
	local controlPacketByte
	local firstRemainingLengthByte
	local remainingLength
	
	$bishbosh_connection_read_byte_blocking controlPacketByte
	if [ -z "$controlPacketByte" ]; then
		core_exitError $core_commandLine_exitCode_IOERR "Read of controlPacketByte failed"
	fi
	if [ $controlPacketByte -ne 32 ]; then
		bishbosh_connection_read_controlpacket_invalid
	fi
	$bishbosh_connection_read_byte_blocking firstRemainingLengthByte
	bishbosh_connection_read_controlpacket_CONNACK >"$bishbosh_connection_toServerFifo"
		
	#bishbosh_connection_writeLoop &
	#bishbosh_connection_writeLoopPid=$!
	#core_children_killOnExit $bishbosh_connection_writeLoopPid

	while $bishbosh_connection_continue
	do
		bishbosh_connection_read_body
	done
}

