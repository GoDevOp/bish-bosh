core_usesIn bishbosh/connection/read/byte gnuCoreutilsPipe

_bishbosh_connection_read_loop_gnuCoreutilsPipe_internal()
{
	local pathToStdbuf="$1"
	local pathToOd="$2"
	shift 2
	
	"$pathToStdbuf" -i 0 -o 0 -e 0 "$pathToOd" -A n -t u1 -w1 -v "$bishbosh_connection_fromServerFifo" >"$bishbosh_connection_fromHexConversionFifo" &
	core_children_killOnExit $!
	
	{
		bishbosh_connection_read_expectingCONNACK
		
		while $bishbosh_connection_continue
		do
			bishbosh_connection_body
		done
		
	} <"$bishbosh_connection_fromHexConversionFifo"
}

bishbosh_connection_read_loop_gnuCoreutilsPipe_Homebrew()
{
	_bishbosh_connection_read_loop_gnuCoreutilsPipe_internal gstdbuf god
}

bishbosh_connection_read_loop_gnuCoreutilsPipe_regular()
{
	_bishbosh_connection_read_loop_gnuCoreutilsPipe_internal stdbuf od
}
