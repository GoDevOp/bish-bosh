bishbosh_connection_read_controlpacket_handlers=()

bishbosh_connection_read_controlpacket_initialise()
{
	local isServer="$1"
	
	local -i index
	for((index=0;index<256;index++))
	do
		bishbosh_connection_read_controlpacket_handlers[$index]=bishbosh_connection_read_controlpacket_invalid
	done
	
	if core_variable_isTrue "$isServer"; then
		bishbosh_connection_read_controlpacket_handlers[16]=bishbosh_connection_read_CONNECT
	else
		# Never expected after initial read
		:
	fi
	
	bishbosh_connection_read_controlpacket_handlers[48]=bishbosh_connection_read_PUBLISH_0
	bishbosh_connection_read_controlpacket_handlers[49]=bishbosh_connection_read_PUBLISH_1
	bishbosh_connection_read_controlpacket_handlers[50]=bishbosh_connection_read_PUBLISH_2
	bishbosh_connection_read_controlpacket_handlers[51]=bishbosh_connection_read_PUBLISH_3
	bishbosh_connection_read_controlpacket_handlers[52]=bishbosh_connection_read_PUBLISH_4
	bishbosh_connection_read_controlpacket_handlers[53]=bishbosh_connection_read_PUBLISH_5
	bishbosh_connection_read_controlpacket_handlers[54]=bishbosh_connection_read_PUBLISH_6
	bishbosh_connection_read_controlpacket_handlers[55]=bishbosh_connection_read_PUBLISH_7
	bishbosh_connection_read_controlpacket_handlers[56]=bishbosh_connection_read_PUBLISH_8
	bishbosh_connection_read_controlpacket_handlers[57]=bishbosh_connection_read_PUBLISH_9
	bishbosh_connection_read_controlpacket_handlers[58]=bishbosh_connection_read_PUBLISH_10
	bishbosh_connection_read_controlpacket_handlers[59]=bishbosh_connection_read_PUBLISH_11
	bishbosh_connection_read_controlpacket_handlers[60]=bishbosh_connection_read_PUBLISH_12
	bishbosh_connection_read_controlpacket_handlers[61]=bishbosh_connection_read_PUBLISH_13
	bishbosh_connection_read_controlpacket_handlers[62]=bishbosh_connection_read_PUBLISH_14
	bishbosh_connection_read_controlpacket_handlers[63]=bishbosh_connection_read_PUBLISH_15
	
	bishbosh_connection_read_controlpacket_handlers[64]=bishbosh_connection_read_PUBACK
	
	bishbosh_connection_read_controlpacket_handlers[80]=bishbosh_connection_read_PUBREC
	
	bishbosh_connection_read_controlpacket_handlers[98]=bishbosh_connection_read_PUBREL
	
	bishbosh_connection_read_controlpacket_handlers[112]=bishbosh_connection_read_PUBCOMP
	
	if core_variable_isTrue "$isServer"; then
		bishbosh_connection_read_controlpacket_handlers[130]=bishbosh_connection_read_SUBSCRIBE
	else
		bishbosh_connection_read_controlpacket_handlers[144]=bishbosh_connection_read_SUBACK
	fi
	
	if core_variable_isTrue "$isServer"; then
		bishbosh_connection_read_controlpacket_handlers[162]=bishbosh_connection_read_UNSUBSCRIBE
	else
		bishbosh_connection_read_controlpacket_handlers[176]=bishbosh_connection_read_UNSUBACK
	fi
	
	if core_variable_isTrue "$isServer"; then
		bishbosh_connection_read_controlpacket_handlers[192]=bishbosh_connection_read_controlpacket_PINGREQ
	else
		bishbosh_connection_read_controlpacket_handlers[208]=bishbosh_connection_read_controlpacket_PINGRESP
	fi
	
	if core_variable_isTrue "$isServer"; then
		bishbosh_connection_read_controlpacket_handlers[224]=bishbosh_connection_read_controlpacket_DISCONNECT
	fi
}

bishbosh_connection_read_controlpacket_handle()
{
	${bishbosh_connection_read_controlpacket_handlers[${controlPacketByte}]}
}
